// This is the CNContentInterface, it will be injected into the page by the app
// when running natively (it's only included here for testing outside the app)
!function a(b,c,d){function e(g,h){if(!c[g]){if(!b[g]){var i="function"==typeof require&&require;if(!h&&i)return i(g,!0);if(f)return f(g,!0);throw new Error("Cannot find module '"+g+"'")}var j=c[g]={exports:{}};b[g][0].call(j.exports,function(a){var c=b[g][1][a];return e(c?c:a)},j,j.exports,a,b,c,d)}return c[g].exports}for(var f="function"==typeof require&&require,g=0;g<d.length;g++)e(d[g]);return e}({1:[function(a,b,c){(function(){var a=this,d=a._,e={},f=Array.prototype,g=Object.prototype,h=Function.prototype,i=f.push,j=f.slice,k=f.concat,l=g.toString,m=g.hasOwnProperty,n=f.forEach,o=f.map,p=f.reduce,q=f.reduceRight,r=f.filter,s=f.every,t=f.some,u=f.indexOf,v=f.lastIndexOf,w=Array.isArray,x=Object.keys,y=h.bind,z=function(a){return a instanceof z?a:this instanceof z?void(this._wrapped=a):new z(a)};"undefined"!=typeof c?("undefined"!=typeof b&&b.exports&&(c=b.exports=z),c._=z):a._=z,z.VERSION="1.5.2";var A=z.each=z.forEach=function(a,b,c){if(null!=a)if(n&&a.forEach===n)a.forEach(b,c);else if(a.length===+a.length){for(var d=0,f=a.length;f>d;d++)if(b.call(c,a[d],d,a)===e)return}else for(var g=z.keys(a),d=0,f=g.length;f>d;d++)if(b.call(c,a[g[d]],g[d],a)===e)return};z.map=z.collect=function(a,b,c){var d=[];return null==a?d:o&&a.map===o?a.map(b,c):(A(a,function(a,e,f){d.push(b.call(c,a,e,f))}),d)};var B="Reduce of empty array with no initial value";z.reduce=z.foldl=z.inject=function(a,b,c,d){var e=arguments.length>2;if(null==a&&(a=[]),p&&a.reduce===p)return d&&(b=z.bind(b,d)),e?a.reduce(b,c):a.reduce(b);if(A(a,function(a,f,g){e?c=b.call(d,c,a,f,g):(c=a,e=!0)}),!e)throw new TypeError(B);return c},z.reduceRight=z.foldr=function(a,b,c,d){var e=arguments.length>2;if(null==a&&(a=[]),q&&a.reduceRight===q)return d&&(b=z.bind(b,d)),e?a.reduceRight(b,c):a.reduceRight(b);var f=a.length;if(f!==+f){var g=z.keys(a);f=g.length}if(A(a,function(h,i,j){i=g?g[--f]:--f,e?c=b.call(d,c,a[i],i,j):(c=a[i],e=!0)}),!e)throw new TypeError(B);return c},z.find=z.detect=function(a,b,c){var d;return C(a,function(a,e,f){return b.call(c,a,e,f)?(d=a,!0):void 0}),d},z.filter=z.select=function(a,b,c){var d=[];return null==a?d:r&&a.filter===r?a.filter(b,c):(A(a,function(a,e,f){b.call(c,a,e,f)&&d.push(a)}),d)},z.reject=function(a,b,c){return z.filter(a,function(a,d,e){return!b.call(c,a,d,e)},c)},z.every=z.all=function(a,b,c){b||(b=z.identity);var d=!0;return null==a?d:s&&a.every===s?a.every(b,c):(A(a,function(a,f,g){return(d=d&&b.call(c,a,f,g))?void 0:e}),!!d)};var C=z.some=z.any=function(a,b,c){b||(b=z.identity);var d=!1;return null==a?d:t&&a.some===t?a.some(b,c):(A(a,function(a,f,g){return d||(d=b.call(c,a,f,g))?e:void 0}),!!d)};z.contains=z.include=function(a,b){return null==a?!1:u&&a.indexOf===u?-1!=a.indexOf(b):C(a,function(a){return a===b})},z.invoke=function(a,b){var c=j.call(arguments,2),d=z.isFunction(b);return z.map(a,function(a){return(d?b:a[b]).apply(a,c)})},z.pluck=function(a,b){return z.map(a,function(a){return a[b]})},z.where=function(a,b,c){return z.isEmpty(b)?c?void 0:[]:z[c?"find":"filter"](a,function(a){for(var c in b)if(b[c]!==a[c])return!1;return!0})},z.findWhere=function(a,b){return z.where(a,b,!0)},z.max=function(a,b,c){if(!b&&z.isArray(a)&&a[0]===+a[0]&&a.length<65535)return Math.max.apply(Math,a);if(!b&&z.isEmpty(a))return-1/0;var d={computed:-1/0,value:-1/0};return A(a,function(a,e,f){var g=b?b.call(c,a,e,f):a;g>d.computed&&(d={value:a,computed:g})}),d.value},z.min=function(a,b,c){if(!b&&z.isArray(a)&&a[0]===+a[0]&&a.length<65535)return Math.min.apply(Math,a);if(!b&&z.isEmpty(a))return 1/0;var d={computed:1/0,value:1/0};return A(a,function(a,e,f){var g=b?b.call(c,a,e,f):a;g<d.computed&&(d={value:a,computed:g})}),d.value},z.shuffle=function(a){var b,c=0,d=[];return A(a,function(a){b=z.random(c++),d[c-1]=d[b],d[b]=a}),d},z.sample=function(a,b,c){return arguments.length<2||c?a[z.random(a.length-1)]:z.shuffle(a).slice(0,Math.max(0,b))};var D=function(a){return z.isFunction(a)?a:function(b){return b[a]}};z.sortBy=function(a,b,c){var d=D(b);return z.pluck(z.map(a,function(a,b,e){return{value:a,index:b,criteria:d.call(c,a,b,e)}}).sort(function(a,b){var c=a.criteria,d=b.criteria;if(c!==d){if(c>d||void 0===c)return 1;if(d>c||void 0===d)return-1}return a.index-b.index}),"value")};var E=function(a){return function(b,c,d){var e={},f=null==c?z.identity:D(c);return A(b,function(c,g){var h=f.call(d,c,g,b);a(e,h,c)}),e}};z.groupBy=E(function(a,b,c){(z.has(a,b)?a[b]:a[b]=[]).push(c)}),z.indexBy=E(function(a,b,c){a[b]=c}),z.countBy=E(function(a,b){z.has(a,b)?a[b]++:a[b]=1}),z.sortedIndex=function(a,b,c,d){c=null==c?z.identity:D(c);for(var e=c.call(d,b),f=0,g=a.length;g>f;){var h=f+g>>>1;c.call(d,a[h])<e?f=h+1:g=h}return f},z.toArray=function(a){return a?z.isArray(a)?j.call(a):a.length===+a.length?z.map(a,z.identity):z.values(a):[]},z.size=function(a){return null==a?0:a.length===+a.length?a.length:z.keys(a).length},z.first=z.head=z.take=function(a,b,c){return null==a?void 0:null==b||c?a[0]:j.call(a,0,b)},z.initial=function(a,b,c){return j.call(a,0,a.length-(null==b||c?1:b))},z.last=function(a,b,c){return null==a?void 0:null==b||c?a[a.length-1]:j.call(a,Math.max(a.length-b,0))},z.rest=z.tail=z.drop=function(a,b,c){return j.call(a,null==b||c?1:b)},z.compact=function(a){return z.filter(a,z.identity)};var F=function(a,b,c){return b&&z.every(a,z.isArray)?k.apply(c,a):(A(a,function(a){z.isArray(a)||z.isArguments(a)?b?i.apply(c,a):F(a,b,c):c.push(a)}),c)};z.flatten=function(a,b){return F(a,b,[])},z.without=function(a){return z.difference(a,j.call(arguments,1))},z.uniq=z.unique=function(a,b,c,d){z.isFunction(b)&&(d=c,c=b,b=!1);var e=c?z.map(a,c,d):a,f=[],g=[];return A(e,function(c,d){(b?d&&g[g.length-1]===c:z.contains(g,c))||(g.push(c),f.push(a[d]))}),f},z.union=function(){return z.uniq(z.flatten(arguments,!0))},z.intersection=function(a){var b=j.call(arguments,1);return z.filter(z.uniq(a),function(a){return z.every(b,function(b){return z.indexOf(b,a)>=0})})},z.difference=function(a){var b=k.apply(f,j.call(arguments,1));return z.filter(a,function(a){return!z.contains(b,a)})},z.zip=function(){for(var a=z.max(z.pluck(arguments,"length").concat(0)),b=new Array(a),c=0;a>c;c++)b[c]=z.pluck(arguments,""+c);return b},z.object=function(a,b){if(null==a)return{};for(var c={},d=0,e=a.length;e>d;d++)b?c[a[d]]=b[d]:c[a[d][0]]=a[d][1];return c},z.indexOf=function(a,b,c){if(null==a)return-1;var d=0,e=a.length;if(c){if("number"!=typeof c)return d=z.sortedIndex(a,b),a[d]===b?d:-1;d=0>c?Math.max(0,e+c):c}if(u&&a.indexOf===u)return a.indexOf(b,c);for(;e>d;d++)if(a[d]===b)return d;return-1},z.lastIndexOf=function(a,b,c){if(null==a)return-1;var d=null!=c;if(v&&a.lastIndexOf===v)return d?a.lastIndexOf(b,c):a.lastIndexOf(b);for(var e=d?c:a.length;e--;)if(a[e]===b)return e;return-1},z.range=function(a,b,c){arguments.length<=1&&(b=a||0,a=0),c=arguments[2]||1;for(var d=Math.max(Math.ceil((b-a)/c),0),e=0,f=new Array(d);d>e;)f[e++]=a,a+=c;return f};var G=function(){};z.bind=function(a,b){var c,d;if(y&&a.bind===y)return y.apply(a,j.call(arguments,1));if(!z.isFunction(a))throw new TypeError;return c=j.call(arguments,2),d=function(){if(!(this instanceof d))return a.apply(b,c.concat(j.call(arguments)));G.prototype=a.prototype;var e=new G;G.prototype=null;var f=a.apply(e,c.concat(j.call(arguments)));return Object(f)===f?f:e}},z.partial=function(a){var b=j.call(arguments,1);return function(){return a.apply(this,b.concat(j.call(arguments)))}},z.bindAll=function(a){var b=j.call(arguments,1);if(0===b.length)throw new Error("bindAll must be passed function names");return A(b,function(b){a[b]=z.bind(a[b],a)}),a},z.memoize=function(a,b){var c={};return b||(b=z.identity),function(){var d=b.apply(this,arguments);return z.has(c,d)?c[d]:c[d]=a.apply(this,arguments)}},z.delay=function(a,b){var c=j.call(arguments,2);return setTimeout(function(){return a.apply(null,c)},b)},z.defer=function(a){return z.delay.apply(z,[a,1].concat(j.call(arguments,1)))},z.throttle=function(a,b,c){var d,e,f,g=null,h=0;c||(c={});var i=function(){h=c.leading===!1?0:new Date,g=null,f=a.apply(d,e)};return function(){var j=new Date;h||c.leading!==!1||(h=j);var k=b-(j-h);return d=this,e=arguments,0>=k?(clearTimeout(g),g=null,h=j,f=a.apply(d,e)):g||c.trailing===!1||(g=setTimeout(i,k)),f}},z.debounce=function(a,b,c){var d,e,f,g,h;return function(){f=this,e=arguments,g=new Date;var i=function(){var j=new Date-g;b>j?d=setTimeout(i,b-j):(d=null,c||(h=a.apply(f,e)))},j=c&&!d;return d||(d=setTimeout(i,b)),j&&(h=a.apply(f,e)),h}},z.once=function(a){var b,c=!1;return function(){return c?b:(c=!0,b=a.apply(this,arguments),a=null,b)}},z.wrap=function(a,b){return function(){var c=[a];return i.apply(c,arguments),b.apply(this,c)}},z.compose=function(){var a=arguments;return function(){for(var b=arguments,c=a.length-1;c>=0;c--)b=[a[c].apply(this,b)];return b[0]}},z.after=function(a,b){return function(){return--a<1?b.apply(this,arguments):void 0}},z.keys=x||function(a){if(a!==Object(a))throw new TypeError("Invalid object");var b=[];for(var c in a)z.has(a,c)&&b.push(c);return b},z.values=function(a){for(var b=z.keys(a),c=b.length,d=new Array(c),e=0;c>e;e++)d[e]=a[b[e]];return d},z.pairs=function(a){for(var b=z.keys(a),c=b.length,d=new Array(c),e=0;c>e;e++)d[e]=[b[e],a[b[e]]];return d},z.invert=function(a){for(var b={},c=z.keys(a),d=0,e=c.length;e>d;d++)b[a[c[d]]]=c[d];return b},z.functions=z.methods=function(a){var b=[];for(var c in a)z.isFunction(a[c])&&b.push(c);return b.sort()},z.extend=function(a){return A(j.call(arguments,1),function(b){if(b)for(var c in b)a[c]=b[c]}),a},z.pick=function(a){var b={},c=k.apply(f,j.call(arguments,1));return A(c,function(c){c in a&&(b[c]=a[c])}),b},z.omit=function(a){var b={},c=k.apply(f,j.call(arguments,1));for(var d in a)z.contains(c,d)||(b[d]=a[d]);return b},z.defaults=function(a){return A(j.call(arguments,1),function(b){if(b)for(var c in b)void 0===a[c]&&(a[c]=b[c])}),a},z.clone=function(a){return z.isObject(a)?z.isArray(a)?a.slice():z.extend({},a):a},z.tap=function(a,b){return b(a),a};var H=function(a,b,c,d){if(a===b)return 0!==a||1/a==1/b;if(null==a||null==b)return a===b;a instanceof z&&(a=a._wrapped),b instanceof z&&(b=b._wrapped);var e=l.call(a);if(e!=l.call(b))return!1;switch(e){case"[object String]":return a==String(b);case"[object Number]":return a!=+a?b!=+b:0==a?1/a==1/b:a==+b;case"[object Date]":case"[object Boolean]":return+a==+b;case"[object RegExp]":return a.source==b.source&&a.global==b.global&&a.multiline==b.multiline&&a.ignoreCase==b.ignoreCase}if("object"!=typeof a||"object"!=typeof b)return!1;for(var f=c.length;f--;)if(c[f]==a)return d[f]==b;var g=a.constructor,h=b.constructor;if(g!==h&&!(z.isFunction(g)&&g instanceof g&&z.isFunction(h)&&h instanceof h))return!1;c.push(a),d.push(b);var i=0,j=!0;if("[object Array]"==e){if(i=a.length,j=i==b.length)for(;i--&&(j=H(a[i],b[i],c,d)););}else{for(var k in a)if(z.has(a,k)&&(i++,!(j=z.has(b,k)&&H(a[k],b[k],c,d))))break;if(j){for(k in b)if(z.has(b,k)&&!i--)break;j=!i}}return c.pop(),d.pop(),j};z.isEqual=function(a,b){return H(a,b,[],[])},z.isEmpty=function(a){if(null==a)return!0;if(z.isArray(a)||z.isString(a))return 0===a.length;for(var b in a)if(z.has(a,b))return!1;return!0},z.isElement=function(a){return!(!a||1!==a.nodeType)},z.isArray=w||function(a){return"[object Array]"==l.call(a)},z.isObject=function(a){return a===Object(a)},A(["Arguments","Function","String","Number","Date","RegExp"],function(a){z["is"+a]=function(b){return l.call(b)=="[object "+a+"]"}}),z.isArguments(arguments)||(z.isArguments=function(a){return!(!a||!z.has(a,"callee"))}),"function"!=typeof/./&&(z.isFunction=function(a){return"function"==typeof a}),z.isFinite=function(a){return isFinite(a)&&!isNaN(parseFloat(a))},z.isNaN=function(a){return z.isNumber(a)&&a!=+a},z.isBoolean=function(a){return a===!0||a===!1||"[object Boolean]"==l.call(a)},z.isNull=function(a){return null===a},z.isUndefined=function(a){return void 0===a},z.has=function(a,b){return m.call(a,b)},z.noConflict=function(){return a._=d,this},z.identity=function(a){return a},z.times=function(a,b,c){for(var d=Array(Math.max(0,a)),e=0;a>e;e++)d[e]=b.call(c,e);return d},z.random=function(a,b){return null==b&&(b=a,a=0),a+Math.floor(Math.random()*(b-a+1))};var I={escape:{"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#x27;"}};I.unescape=z.invert(I.escape);var J={escape:new RegExp("["+z.keys(I.escape).join("")+"]","g"),unescape:new RegExp("("+z.keys(I.unescape).join("|")+")","g")};z.each(["escape","unescape"],function(a){z[a]=function(b){return null==b?"":(""+b).replace(J[a],function(b){return I[a][b]})}}),z.result=function(a,b){if(null==a)return void 0;var c=a[b];return z.isFunction(c)?c.call(a):c},z.mixin=function(a){A(z.functions(a),function(b){var c=z[b]=a[b];z.prototype[b]=function(){var a=[this._wrapped];return i.apply(a,arguments),O.call(this,c.apply(z,a))}})};var K=0;z.uniqueId=function(a){var b=++K+"";return a?a+b:b},z.templateSettings={evaluate:/<%([\s\S]+?)%>/g,interpolate:/<%=([\s\S]+?)%>/g,escape:/<%-([\s\S]+?)%>/g};var L=/(.)^/,M={"'":"'","\\":"\\","\r":"r","\n":"n","	":"t","\u2028":"u2028","\u2029":"u2029"},N=/\\|'|\r|\n|\t|\u2028|\u2029/g;z.template=function(a,b,c){var d;c=z.defaults({},c,z.templateSettings);var e=new RegExp([(c.escape||L).source,(c.interpolate||L).source,(c.evaluate||L).source].join("|")+"|$","g"),f=0,g="__p+='";a.replace(e,function(b,c,d,e,h){return g+=a.slice(f,h).replace(N,function(a){return"\\"+M[a]}),c&&(g+="'+\n((__t=("+c+"))==null?'':_.escape(__t))+\n'"),d&&(g+="'+\n((__t=("+d+"))==null?'':__t)+\n'"),e&&(g+="';\n"+e+"\n__p+='"),f=h+b.length,b}),g+="';\n",c.variable||(g="with(obj||{}){\n"+g+"}\n"),g="var __t,__p='',__j=Array.prototype.join,print=function(){__p+=__j.call(arguments,'');};\n"+g+"return __p;\n";try{d=new Function(c.variable||"obj","_",g)}catch(h){throw h.source=g,h}if(b)return d(b,z);var i=function(a){return d.call(this,a,z)};return i.source="function("+(c.variable||"obj")+"){\n"+g+"}",i},z.chain=function(a){return z(a).chain()};var O=function(a){return this._chain?z(a).chain():a};z.mixin(z),A(["pop","push","reverse","shift","sort","splice","unshift"],function(a){var b=f[a];z.prototype[a]=function(){var c=this._wrapped;return b.apply(c,arguments),"shift"!=a&&"splice"!=a||0!==c.length||delete c[0],O.call(this,c)}}),A(["concat","join","slice"],function(a){var b=f[a];z.prototype[a]=function(){return O.call(this,b.apply(this._wrapped,arguments))}}),z.extend(z.prototype,{chain:function(){return this._chain=!0,this},value:function(){return this._wrapped}})}).call(this)},{}],2:[function(a,b){var c=a("underscore"),d=a("../../external/hammer"),e=a("../../dreamsocket/utils/ObjectUtil"),f=a("../../dreamsocket/utils/OSUtil"),g=a("../../dreamsocket/utils/Timer"),h=a("../../dreamsocket/utils/NativeInterface"),i=a("./ContentInterfaceAudio.js"),j=a("./ContentStorage"),k=a("../util/DataUtil"),l=["id","url","loop","background","fade"],m=["id","url","background","all","fade"],n={m_gestureHandlers:null,m_timer:null,m_nativeinterface:null,m_data:void 0,m_delegate:null,m_debugDelegate:null,m_currentSegment:-1,m_currentSegmentProperties:null,m_isReady:!1,m_isPaused:!1,m_shouldStartNextSegmentAfterResume:!1,m_storage:null,$init:function(){var a=e.create(this);return window.CNContentInterface=this,window.CNAudio=i.init(),a},init:function(a){console.log("init bridge"),this.m_nativeinterface=h.init("cnnativebridge"),this.m_storage=j.init(self.m_nativeinterface,a),this.$dispatchLoaded()},ready:function(a){if(this.m_isReady=!0,!a)throw new Error("CNContentInterface.ready() must be called with a delegate parameter. See: https://github.com/dreamsocket/CNAnythingContent#ready");this.m_delegate=a,this.m_debugDelegate&&this.m_debugDelegate.ready&&this.m_debugDelegate.ready(),this.m_nativeinterface.executeCommand("ready",null)},startNextSegment:function(){if(!this.m_isReady)throw new Error("CNContentInterface.ready(delegate) must be called before starting the first segment.");this.$startNextSegment(!0)},tick:function(a,b){if(0>a||!b)throw new Error("CNContentInterface.tick requires both a time and duration parameter.");this.$tick(a,b)},getData:function(){return void 0===this.m_data&&(this.m_data=k.getData()),this.m_data},setItem:function(a,b){this.m_storage.setItem(a,b)},getItem:function(a){return this.m_storage.getItem(a)},playAudio:function(a){if(!a)throw new Error("CNContentInterface.playAudio(options) must be called with an `options` object. See: https://github.com/dreamsocket/CNAnythingContent#playAudio");if(!a.url&&!a.id)throw new Error("CNContentInterface.playAudio(options) must be called with either options.id or options.url defined. See: https://github.com/dreamsocket/CNAnythingContent#playAudio");a.id&&console.log("Playing audio: "+a.id);var b=this.$cleanAudioOptions(a,l,"playAudio");b.command="play",this.m_nativeinterface.executeCommand("playAudio",b)},stopAudio:function(a){if(!a)throw new Error("CNContentInterface.stopAudio(options) must be called with an `options` object. See: https://github.com/dreamsocket/CNAnythingContent#stopAudio");if(!(a.url||a.id||a.all))throw new Error("CNContentInterface.stopAudio(options) must be called with either options.id, options.url or options.all defined. See: https://github.com/dreamsocket/CNAnythingContent#stopAudio");a.id&&console.log("Stopping audio: "+a.id);var b=this.$cleanAudioOptions(a,m,"stopAudio");b.command="stop",this.m_nativeinterface.executeCommand("stopAudio",b)},start:function(){console.log("start"),this.$startNextSegment(!1)},pause:function(){console.log("pause"),this.m_isPaused=!0,this.$callDelegateMethod("pause"),this.m_timer&&this.m_timer.pause()},resume:function(){console.log("resume"),this.m_isPaused=!1,this.$callDelegateMethod("resume"),this.m_shouldStartNextSegmentAfterResume?this.$startNextSegment(!1):this.m_timer&&this.m_timer.resume()},getCurrentSegmentIndex:function(){return this.m_currentSegment},setDebugDelegate:function(a){this.m_debugDelegate=a},$startNextSegment:function(a){if(this.m_isPaused)return void(this.m_shouldStartNextSegmentAfterResume=!0);var b=this.m_currentSegment+1,d=this.$callDelegateMethod("propertiesForSegment",b);if(this.$cancelTimer(),d&&d.duration){var e=d.duration;console.log("start segment: "+b+" duration: "+e),this.$addSkipGestureHandlers(d.skippable),this.m_currentSegmentProperties=d,this.$callDelegateMethod("startSegment",b,d,a),this.m_currentSegment=b;var f={};if(f.segmentID=b,d&&c.extend(f,d),this.m_nativeinterface.executeCommand("startSegment",f),-1!=e){var g=this;this.$startTimer(e,function(){g.$startNextSegment(!1)})}}else this.$complete(a)},$complete:function(a){console.log("complete"),this.m_debugDelegate&&this.m_debugDelegate.complete&&this.m_debugDelegate.complete(),this.$callDelegateMethod("complete",a);var b=this;c.delay(function(){b.m_nativeinterface.executeCommand("complete",{savedItems:b.m_storage.getItems()}),b.m_currentSegment=-1},50)},$startTimer:function(a,b){this.$cancelTimer();var c=this;this.m_timer=g.init(function(b){c.$tick(b/1e3,a)},function(){b()},1e3*a,100)},$cancelTimer:function(){this.m_timer&&(console.log("canceling timer"),this.m_timer.cancel())},$tick:function(a,b){this.m_nativeinterface.executeCommand("tick",{time:a,duration:b||this.m_currentSegmentProperties.duration})},$callDelegateMethod:function(a){if(this.m_delegate&&this.m_delegate[a]){var b=Array.prototype.slice.call(arguments,1);return this.m_delegate[a].apply(this.m_delegate,b)}console.log("CNContentInterface delegate does not implement "+a)},$dispatchLoaded:function(){console.log("dispatching CNContentInterfaceLoaded"),window.CNContentInterfaceLoaded=!0;var a=new CustomEvent("CNContentInterfaceLoaded");document.dispatchEvent(a)},$cleanAudioOptions:function(a,b,d){var e=c.pick(a,b);if(c.keys(e).length!=c.keys(a).length)throw new Error("CNContentInterface."+d+"(options) supported options are: "+b.join(", ")+" See: https://github.com/dreamsocket/CNAnythingContent#"+d);if(e.url){var f=window.location.pathname;e.url=f?f.substr(0,f.lastIndexOf("/")+1)+e.url:e.url}return e},$addSkipGestureHandlers:function(a){if(a){if(!this.m_gestureHandlers){var b=this;this.m_gestureHandlers={doubletap:function(){b.$onWindowDoubleTap()},swipeleft:function(){b.$onWindowSwipeLeft()}};var c=d(window);c.on("doubletap",this.m_gestureHandlers.doubletap),c.on("swipeleft",this.m_gestureHandlers.swipeleft)}}else if(this.m_gestureHandlers){var c=d(window);c.off("doubletap",this.m_gestureHandlers.doubletap),c.off("swipeleft",this.m_gestureHandlers.swipeleft)}console.log("segment "+(a?"is":"isn't")+" skippable")},$onWindowDoubleTap:function(){console.log("double tap"),this.startNextSegment()},$onWindowSwipeLeft:function(){console.log("swipe left"),this.startNextSegment()}};window.CNContentInterface||(n.$init(),f.isMobileNative()||("complete"===document.readyState?n.init():document.addEventListener("DOMContentLoaded",function(){n.init()}))),b.exports=n},{"../../dreamsocket/utils/NativeInterface":7,"../../dreamsocket/utils/OSUtil":8,"../../dreamsocket/utils/ObjectUtil":9,"../../dreamsocket/utils/Timer":10,"../../external/hammer":11,"../util/DataUtil":5,"./ContentInterfaceAudio.js":3,"./ContentStorage":4,underscore:1}],3:[function(a,b){var c=(a("underscore"),a("../../dreamsocket/utils/ObjectUtil")),d=(a("../../dreamsocket/utils/OSUtil"),{background_1:"background_1",correct_1:"correct_1",incorrect_1:"incorrect_1",success_1:"success_1",failure_1:"failure_1",background_2:"background_2",submit_1:"submit_1",counter_1:"counter_1",complete_1:"complete_1",background_3:"background_3",complete_2:"complete_2",camera_1:"camera_1",background_4:"background_4",complete_3:"complete_3",reveal_1:"reveal_1",background_5:"background_5",background_6:"background_6",complete_4:"complete_4",background_7:"background_7",correct_2:"correct_2",failure_2:"failure_2",success_2:"success_2",background_8:"background_8",card_flip_1:"card_flip_1",correct_3:"correct_3",incorrect_2:"incorrect_2",failure_3:"failure_3",success_3:"success_3",background_9:"background_9",swipe_1:"swipe_1",init:function(){var a=c.create(this);return a}});b.exports=d},{"../../dreamsocket/utils/OSUtil":8,"../../dreamsocket/utils/ObjectUtil":9,underscore:1}],4:[function(a,b){var c=a("underscore"),d=a("../../dreamsocket/utils/ObjectUtil"),e=a("../../dreamsocket/utils/OSUtil"),f={m_itemLookup:null,m_nativeinterface:null,init:function(a,b){var c=d.create(this);return c.m_nativeinterface=a,c.m_itemLookup=b&&b.savedItems?JSON.parse(b.savedItems):{},console.log(c.m_itemLookup),c},setItem:function(a,b){if(!c.isString(a))throw new Error("CNContentInterface.setItem(key, value) key must be a string. Actual value: "+a);c.isObject(b)&&(b=JSON.stringify(b));var d=c.isObject(b);if(!(c.isNumber(b)||c.isString(b)||d))throw new Error("CNContentInterface.setItem(key, value) value must be a string, number, or valid JSON object. Actual value: "+b);if(d){if(!c.keys(object))return;b=JSON.stringify(b)}console.log("storing key: "+a+" value: "+b),e.isMobileNative()?this.m_itemLookup[a]=b:localStorage.setItem(a,b)},getItem:function(a){if(!c.isString(a))throw new Error("CNContentInterface.getItem(key) key must be a string. Actual value: "+a);var b;if(b=e.isMobileNative()?this.m_itemLookup[a]:localStorage.getItem(a),c.isNumber(b))return parseFloat(b);if(c.isString(b)){try{var d=JSON.parse(b);if(c.isObject(d))return d}catch(f){}return b}return null},getItems:function(){return JSON.stringify(this.m_itemLookup)}};b.exports=f},{"../../dreamsocket/utils/OSUtil":8,"../../dreamsocket/utils/ObjectUtil":9,underscore:1}],5:[function(a,b){var c={getData:function(){try{var a=new XMLHttpRequest;a.onerror=function(){},a.onload=function(){},a.open("GET","segments.json",!1),a.send();var b=a.responseText?JSON.parse(a.responseText):null,c=new XMLHttpRequest;c.open("GET","data.json",!1),c.send();var d=c.responseText?JSON.parse(c.responseText):null;return b?{segments:b,contentData:d}:d}catch(e){return console.log("data error: "+e),null}}};b.exports=c},{}],6:[function(a,b){b.exports={queryStringsEnabled:!0,addQueryParam:function(a,b,c,d){return this.queryStringsEnabled&&(a+=d?d+b+"=":-1!=a.indexOf("?")?"&"+b+"=":"?"+b+"=",a+=null!==c?escape(c):""),a},addQueryParams:function(a,b,c){if(!b)return a;var d;for(d in b)a=this.addQueryParam(a,d,b[d],c);return a},getQueryParam:function(a){var b=a.replace(/[\[]/,"\\[").replace(/[\]]/,"\\]"),c="[\\?&]"+b+"=([^&#]*)",d=new RegExp(c),e=d.exec(window.location.search);return null===e?"":decodeURIComponent(e[1].replace(/\+/g," "))},pingURL:function(a){var b=new Image;b.src=a},resolveUniqueURL:function(a,b){return this.queryStringsEnabled&&-1==a.indexOf("cacheID=")?this.addQueryParam(a,"cacheID",this.getUniqueCacheID(b)):a},getUniqueCacheID:function(a){var b,c=new Date,d=60*c.getUTCMinutes()+c.getUTCSeconds();return b=null===a||0===a?String(c.valueOf()):c.getUTCFullYear()+""+c.getUTCMonth()+c.getUTCDate()+c.getUTCHours()+"-"+Math.floor(d/a)}}},{}],7:[function(a,b){var c=a("./HTTPUtil"),d=a("./OSUtil"),e={init:function(a){var b=Object.create(this);return b.scheme=a,b},executeCommand:function(a,b){var e=b||{};if(window.NativeInterface)window.NativeInterface.callNative(a,JSON.stringify(b));else if(window.webkit&&window.webkit.messageHandlers&&window.webkit.messageHandlers[this.scheme]){var f=JSON.stringify({command:a,params:b});window.webkit.messageHandlers[this.scheme].postMessage(f)}else if(d.isIOSNative()){var g=window.document.documentElement,h=window.document.createElement("IFRAME"),i=c.addQueryParams(this.scheme+"://"+a,e);h.setAttribute("style","position:absolute;top:-999em;left:-999em;"),h.setAttribute("src",i),g.appendChild(h),h.parentNode.removeChild(h)}}};b.exports=e},{"./HTTPUtil":6,"./OSUtil":8}],8:[function(a,b){var c={isAndroid:-1!=window.navigator.userAgent.toLowerCase().indexOf("android"),isIPhone:-1!=window.navigator.userAgent.toLowerCase().indexOf("iphone")||-1!=window.navigator.userAgent.toLowerCase().indexOf("ipod"),isIPad:-1!=window.navigator.userAgent.toLowerCase().indexOf("ipad"),isIOS:-1!=window.navigator.userAgent.toLowerCase().indexOf("ipad")||-1!=window.navigator.userAgent.toLowerCase().indexOf("iphone")||-1!=window.navigator.userAgent.toLowerCase().indexOf("ipod"),isBlackberry:-1!=window.navigator.userAgent.toLowerCase().indexOf("blackberry")||-1!=window.navigator.userAgent.toLowerCase().indexOf("rim"),isMobile:function(){return this.isAndroid||this.isIOS||this.isBlackberry},isIOSNative:function(){return this.isIOS&&-1==window.navigator.userAgent.toLowerCase().indexOf("safari")},isAndroidNative:function(){return this.isAndroid&&-1!=window.navigator.userAgent.toLowerCase().indexOf("mobile")},isMobileNative:function(){return this.isIOSNative()||this.isAndroidNative()},isSmallFormFactor:function(){return this.isIPhone||screen.width<=767},getAndroidOSVersion:function(){if(this.isAndroid){var a=/Android\s+([\d\.]+)/;return this.parseVersionString(a.exec(window.navigator.userAgent)[1])}return null},parseVersionString:function(a){if("string"!=typeof a)return!1;var b=a.split(".");return{major:parseInt(b[0])||0,minor:parseInt(b[1])||0,patch:parseInt(b[2])||0}}};b.exports=c},{}],9:[function(a,b){"function"!=typeof Object.create&&(Object.create=function(a){function b(){}return b.prototype=a,new b}),b.exports={create:Object.create,extend:function(a,b){for(var c in b)b.hasOwnProperty(c)&&(a[c]=b[c]);return a}}},{}],10:[function(a,b){var c=a("../../dreamsocket/utils/ObjectUtil"),d={m_interval:0,m_duration:0,m_complete:!1,m_tickHandler:null,m_completeHandler:null,m_running:!1,m_startTime:0,m_timeElapsed:0,init:function(a,b,d,e){var f=c.create(this);return f.m_tickHandler=a,f.m_completeHandler=b,f.m_duration=d,f.m_interval=e||1e3,f.$reset(),f.$start(),f},$start:function(){var a=this;this.isRunning()||(this.m_startTime=(new Date).valueOf()-this.m_timeElapsed,this.m_running=!0,this.ID=this.complete?-1:setInterval(function(){a.$update()},this.m_interval),this.m_tickHandler(this.getTotalTime()))},$update:function(){this.$getTime(),this.m_complete=this.getTotalTime()>=this.m_duration,this.m_tickHandler(this.getTotalTime()),this.m_complete&&(this.cancel(),this.m_completeHandler())},$getTime:function(){return this.isRunning()&&(this.m_timeElapsed=(new Date).valueOf()-this.m_startTime),this.m_timeElapsed>0?this.m_timeElapsed:0},$reset:function(){this.m_running=!1,this.m_startTime=0,this.m_timeElapsed=0},getTotalTime:function(){return this.$getTime()},cancel:function(){this.m_running=!1,clearInterval(this.ID),this.$reset()},stop:function(){this.isRunning()&&(this.m_timeElapsed=(new Date).valueOf()-this.m_startTime,this.m_running=!1,clearInterval(this.ID))},pause:function(){clearInterval(this.ID),this.m_running=!1,this.$update()},resume:function(){this.$start()},isRunning:function(){return this.m_running}};b.exports=d},{"../../dreamsocket/utils/ObjectUtil":9}],11:[function(a,b){!function(a,c){"use strict";function d(){e.READY||(t.determineEventTypes(),p.each(e.gestures,function(a){v.register(a)}),t.onTouch(e.DOCUMENT,n,v.detect),t.onTouch(e.DOCUMENT,o,v.detect),e.READY=!0)}var e=function(a,b){return new e.Instance(a,b||{})};e.VERSION="1.0.10",e.defaults={stop_browser_behavior:{userSelect:"none",touchAction:"none",touchCallout:"none",contentZooming:"none",userDrag:"none",tapHighlightColor:"rgba(0,0,0,0)"}},e.HAS_POINTEREVENTS=a.navigator.pointerEnabled||a.navigator.msPointerEnabled,e.HAS_TOUCHEVENTS="ontouchstart"in a,e.MOBILE_REGEX=/mobile|tablet|ip(ad|hone|od)|android|silk/i,e.NO_MOUSEEVENTS=e.HAS_TOUCHEVENTS&&a.navigator.userAgent.match(e.MOBILE_REGEX),e.EVENT_TYPES={},e.UPDATE_VELOCITY_INTERVAL=16,e.DOCUMENT=a.document;var f=e.DIRECTION_DOWN="down",g=e.DIRECTION_LEFT="left",h=e.DIRECTION_UP="up",i=e.DIRECTION_RIGHT="right",j=e.POINTER_MOUSE="mouse",k=e.POINTER_TOUCH="touch",l=e.POINTER_PEN="pen",m=e.EVENT_START="start",n=e.EVENT_MOVE="move",o=e.EVENT_END="end";e.plugins=e.plugins||{},e.gestures=e.gestures||{},e.READY=!1;var p=e.utils={extend:function(a,b,d){for(var e in b)a[e]!==c&&d||(a[e]=b[e]);return a},each:function(a,b,d){var e,f;if("forEach"in a)a.forEach(b,d);else if(a.length!==c){for(e=-1;f=a[++e];)if(b.call(d,f,e,a)===!1)return}else for(e in a)if(a.hasOwnProperty(e)&&b.call(d,a[e],e,a)===!1)return},inStr:function(a,b){return a.indexOf(b)>-1},hasParent:function(a,b){for(;a;){if(a==b)return!0;a=a.parentNode}return!1},getCenter:function(a){var b=[],c=[],d=[],e=[],f=Math.min,g=Math.max;return 1===a.length?{pageX:a[0].pageX,pageY:a[0].pageY,clientX:a[0].clientX,clientY:a[0].clientY}:(p.each(a,function(a){b.push(a.pageX),c.push(a.pageY),d.push(a.clientX),e.push(a.clientY)}),{pageX:(f.apply(Math,b)+g.apply(Math,b))/2,pageY:(f.apply(Math,c)+g.apply(Math,c))/2,clientX:(f.apply(Math,d)+g.apply(Math,d))/2,clientY:(f.apply(Math,e)+g.apply(Math,e))/2})},getVelocity:function(a,b,c){return{x:Math.abs(b/a)||0,y:Math.abs(c/a)||0}},getAngle:function(a,b){var c=b.clientX-a.clientX,d=b.clientY-a.clientY;return 180*Math.atan2(d,c)/Math.PI},getDirection:function(a,b){var c=Math.abs(a.clientX-b.clientX),d=Math.abs(a.clientY-b.clientY);return c>=d?a.clientX-b.clientX>0?g:i:a.clientY-b.clientY>0?h:f},getDistance:function(a,b){var c=b.clientX-a.clientX,d=b.clientY-a.clientY;return Math.sqrt(c*c+d*d)},getScale:function(a,b){return a.length>=2&&b.length>=2?this.getDistance(b[0],b[1])/this.getDistance(a[0],a[1]):1},getRotation:function(a,b){return a.length>=2&&b.length>=2?this.getAngle(b[1],b[0])-this.getAngle(a[1],a[0]):0},isVertical:function(a){return a==h||a==f},toggleDefaultBehavior:function(a,b,c){if(b&&a&&a.style){p.each(["webkit","moz","Moz","ms","o",""],function(d){p.each(b,function(b,e){d&&(e=d+e.substring(0,1).toUpperCase()+e.substring(1)),e in a.style&&(a.style[e]=!c&&b)})});var d=function(){return!1};"none"==b.userSelect&&(a.onselectstart=!c&&d),"none"==b.userDrag&&(a.ondragstart=!c&&d)}}};e.Instance=function(a,b){var c=this;return d(),this.element=a,this.enabled=!0,this.options=p.extend(p.extend({},e.defaults),b||{}),this.options.stop_browser_behavior&&p.toggleDefaultBehavior(this.element,this.options.stop_browser_behavior,!1),this.eventStartHandler=t.onTouch(a,m,function(a){c.enabled&&v.startDetect(c,a)
}),this.eventHandlers=[],this},e.Instance.prototype={on:function(a,b){var c=a.split(" ");return p.each(c,function(a){this.element.addEventListener(a,b,!1),this.eventHandlers.push({gesture:a,handler:b})},this),this},off:function(a,b){var c,d,e=a.split(" ");return p.each(e,function(a){for(this.element.removeEventListener(a,b,!1),c=-1;d=this.eventHandlers[++c];)d.gesture===a&&d.handler===b&&this.eventHandlers.splice(c,1)},this),this},trigger:function(a,b){b||(b={});var c=e.DOCUMENT.createEvent("Event");c.initEvent(a,!0,!0),c.gesture=b;var d=this.element;return p.hasParent(b.target,d)&&(d=b.target),d.dispatchEvent(c),this},enable:function(a){return this.enabled=a,this},dispose:function(){var a,b;for(this.options.stop_browser_behavior&&p.toggleDefaultBehavior(this.element,this.options.stop_browser_behavior,!0),a=-1;b=this.eventHandlers[++a];)this.element.removeEventListener(b.gesture,b.handler,!1);return this.eventHandlers=[],t.unbindDom(this.element,e.EVENT_TYPES[m],this.eventStartHandler),null}};var q=null,r=!1,s=!1,t=e.event={bindDom:function(a,b,c){var d=b.split(" ");p.each(d,function(b){a.addEventListener(b,c,!1)})},unbindDom:function(a,b,c){var d=b.split(" ");p.each(d,function(b){a.removeEventListener(b,c,!1)})},onTouch:function(a,b,c){var d=this,f=function(f){var g=f.type.toLowerCase();if(!p.inStr(g,"mouse")||!s){p.inStr(g,"touch")||p.inStr(g,"pointerdown")||p.inStr(g,"mouse")&&1===f.which?r=!0:p.inStr(g,"mouse")&&!f.which&&(r=!1),(p.inStr(g,"touch")||p.inStr(g,"pointer"))&&(s=!0);var h=0;r&&(e.HAS_POINTEREVENTS&&b!=o?h=u.updatePointer(b,f):p.inStr(g,"touch")?h=f.touches.length:s||(h=p.inStr(g,"up")?0:1),h>0&&b==o?b=n:h||(b=o),(h||null===q)&&(q=f),c.call(v,d.collectEventData(a,b,d.getTouchList(q,b),f)),e.HAS_POINTEREVENTS&&b==o&&(h=u.updatePointer(b,f))),h||(q=null,r=!1,s=!1,u.reset())}};return this.bindDom(a,e.EVENT_TYPES[b],f),f},determineEventTypes:function(){var a;a=e.HAS_POINTEREVENTS?u.getEvents():e.NO_MOUSEEVENTS?["touchstart","touchmove","touchend touchcancel"]:["touchstart mousedown","touchmove mousemove","touchend touchcancel mouseup"],e.EVENT_TYPES[m]=a[0],e.EVENT_TYPES[n]=a[1],e.EVENT_TYPES[o]=a[2]},getTouchList:function(a){return e.HAS_POINTEREVENTS?u.getTouchList():a.touches?a.touches:(a.identifier=1,[a])},collectEventData:function(a,b,c,d){var e=k;return(p.inStr(d.type,"mouse")||u.matchType(j,d))&&(e=j),{center:p.getCenter(c),timeStamp:Date.now(),target:d.target,touches:c,eventType:b,pointerType:e,srcEvent:d,preventDefault:function(){var a=this.srcEvent;a.preventManipulation&&a.preventManipulation(),a.preventDefault&&a.preventDefault()},stopPropagation:function(){this.srcEvent.stopPropagation()},stopDetect:function(){return v.stopDetect()}}}},u=e.PointerEvent={pointers:{},getTouchList:function(){var a=[];return p.each(this.pointers,function(b){a.push(b)}),a},updatePointer:function(a,b){return a==o?delete this.pointers[b.pointerId]:(b.identifier=b.pointerId,this.pointers[b.pointerId]=b),Object.keys(this.pointers).length},matchType:function(a,b){if(!b.pointerType)return!1;var c=b.pointerType,d={};return d[j]=c===j,d[k]=c===k,d[l]=c===l,d[a]},getEvents:function(){return["pointerdown MSPointerDown","pointermove MSPointerMove","pointerup pointercancel MSPointerUp MSPointerCancel"]},reset:function(){this.pointers={}}},v=e.detection={gestures:[],current:null,previous:null,stopped:!1,startDetect:function(a,b){this.current||(this.stopped=!1,this.current={inst:a,startEvent:p.extend({},b),lastEvent:!1,lastVelocityEvent:!1,velocity:!1,name:""},this.detect(b))},detect:function(a){if(this.current&&!this.stopped){a=this.extendEventData(a);var b=this.current.inst,c=b.options;return p.each(this.gestures,function(d){return this.stopped||c[d.name]===!1||b.enabled===!1||d.handler.call(d,a,b)!==!1?void 0:(this.stopDetect(),!1)},this),this.current&&(this.current.lastEvent=a),a.eventType==o&&!a.touches.length-1&&this.stopDetect(),a}},stopDetect:function(){this.previous=p.extend({},this.current),this.current=null,this.stopped=!0},getVelocityData:function(a,b,c,d){var f=this.current,g=f.lastVelocityEvent,h=f.velocity;g&&a.timeStamp-g.timeStamp>e.UPDATE_VELOCITY_INTERVAL?(h=p.getVelocity(a.timeStamp-g.timeStamp,a.center.clientX-g.center.clientX,a.center.clientY-g.center.clientY),f.lastVelocityEvent=a):f.velocity||(h=p.getVelocity(b,c,d),f.lastVelocityEvent=a),f.velocity=h,a.velocityX=h.x,a.velocityY=h.y},getInterimData:function(a){var b,c,d=this.current.lastEvent;a.eventType==o?(b=d&&d.interimAngle,c=d&&d.interimDirection):(b=d&&p.getAngle(d.center,a.center),c=d&&p.getDirection(d.center,a.center)),a.interimAngle=b,a.interimDirection=c},extendEventData:function(a){var b=this.current,c=b.startEvent;(a.touches.length!=c.touches.length||a.touches===c.touches)&&(c.touches=[],p.each(a.touches,function(a){c.touches.push(p.extend({},a))}));var d=a.timeStamp-c.timeStamp,e=a.center.clientX-c.center.clientX,f=a.center.clientY-c.center.clientY;return this.getVelocityData(a,d,e,f),this.getInterimData(a),p.extend(a,{startEvent:c,deltaTime:d,deltaX:e,deltaY:f,distance:p.getDistance(c.center,a.center),angle:p.getAngle(c.center,a.center),direction:p.getDirection(c.center,a.center),scale:p.getScale(c.touches,a.touches),rotation:p.getRotation(c.touches,a.touches)}),a},register:function(a){var b=a.defaults||{};return b[a.name]===c&&(b[a.name]=!0),p.extend(e.defaults,b,!0),a.index=a.index||1e3,this.gestures.push(a),this.gestures.sort(function(a,b){return a.index<b.index?-1:a.index>b.index?1:0}),this.gestures}};e.gestures.Drag={name:"drag",index:50,defaults:{drag_min_distance:10,correct_for_drag_min_distance:!0,drag_max_touches:1,drag_block_horizontal:!1,drag_block_vertical:!1,drag_lock_to_axis:!1,drag_lock_min_distance:25},triggered:!1,handler:function(a,b){var c=v.current;if(c.name!=this.name&&this.triggered)return b.trigger(this.name+"end",a),void(this.triggered=!1);if(!(b.options.drag_max_touches>0&&a.touches.length>b.options.drag_max_touches))switch(a.eventType){case m:this.triggered=!1;break;case n:if(a.distance<b.options.drag_min_distance&&c.name!=this.name)return;var d=c.startEvent.center;if(c.name!=this.name&&(c.name=this.name,b.options.correct_for_drag_min_distance&&a.distance>0)){var e=Math.abs(b.options.drag_min_distance/a.distance);d.pageX+=a.deltaX*e,d.pageY+=a.deltaY*e,d.clientX+=a.deltaX*e,d.clientY+=a.deltaY*e,a=v.extendEventData(a)}(c.lastEvent.drag_locked_to_axis||b.options.drag_lock_to_axis&&b.options.drag_lock_min_distance<=a.distance)&&(a.drag_locked_to_axis=!0);var j=c.lastEvent.direction;a.drag_locked_to_axis&&j!==a.direction&&(a.direction=p.isVertical(j)?a.deltaY<0?h:f:a.deltaX<0?g:i),this.triggered||(b.trigger(this.name+"start",a),this.triggered=!0),b.trigger(this.name,a),b.trigger(this.name+a.direction,a);var k=p.isVertical(a.direction);(b.options.drag_block_vertical&&k||b.options.drag_block_horizontal&&!k)&&a.preventDefault();break;case o:this.triggered&&b.trigger(this.name+"end",a),this.triggered=!1}}},e.gestures.Hold={name:"hold",index:10,defaults:{hold_timeout:500,hold_threshold:2},timer:null,handler:function(a,b){switch(a.eventType){case m:clearTimeout(this.timer),v.current.name=this.name,this.timer=setTimeout(function(){"hold"==v.current.name&&b.trigger("hold",a)},b.options.hold_timeout);break;case n:a.distance>b.options.hold_threshold&&clearTimeout(this.timer);break;case o:clearTimeout(this.timer)}}},e.gestures.Release={name:"release",index:1/0,handler:function(a,b){a.eventType==o&&b.trigger(this.name,a)}},e.gestures.Swipe={name:"swipe",index:40,defaults:{swipe_min_touches:1,swipe_max_touches:1,swipe_velocity:.7},handler:function(a,b){if(a.eventType==o){if(a.touches.length<b.options.swipe_min_touches||a.touches.length>b.options.swipe_max_touches)return;(a.velocityX>b.options.swipe_velocity||a.velocityY>b.options.swipe_velocity)&&(b.trigger(this.name,a),b.trigger(this.name+a.direction,a))}}},e.gestures.Tap={name:"tap",index:100,defaults:{tap_max_touchtime:250,tap_max_distance:10,tap_always:!0,doubletap_distance:20,doubletap_interval:300},has_moved:!1,handler:function(a,b){var c,d,e;a.eventType==m?this.has_moved=!1:a.eventType!=n||this.moved?a.eventType==o&&"touchcancel"!=a.srcEvent.type&&a.deltaTime<b.options.tap_max_touchtime&&!this.has_moved&&(c=v.previous,d=c&&c.lastEvent&&a.timeStamp-c.lastEvent.timeStamp,e=!1,c&&"tap"==c.name&&d&&d<b.options.doubletap_interval&&a.distance<b.options.doubletap_distance&&(b.trigger("doubletap",a),e=!0),(!e||b.options.tap_always)&&(v.current.name="tap",b.trigger(v.current.name,a))):this.has_moved=a.distance>b.options.tap_max_distance}},e.gestures.Touch={name:"touch",index:-1/0,defaults:{prevent_default:!1,prevent_mouseevents:!1},handler:function(a,b){return b.options.prevent_mouseevents&&a.pointerType==j?void a.stopDetect():(b.options.prevent_default&&a.preventDefault(),void(a.eventType==m&&b.trigger(this.name,a)))}},e.gestures.Transform={name:"transform",index:45,defaults:{transform_min_scale:.01,transform_min_rotation:1,transform_always_block:!1,transform_within_instance:!1},triggered:!1,handler:function(a,b){if(v.current.name!=this.name&&this.triggered)return b.trigger(this.name+"end",a),void(this.triggered=!1);if(!(a.touches.length<2)){if(b.options.transform_always_block&&a.preventDefault(),b.options.transform_within_instance)for(var c=-1;a.touches[++c];)if(!p.hasParent(a.touches[c].target,b.element))return;switch(a.eventType){case m:this.triggered=!1;break;case n:var d=Math.abs(1-a.scale),e=Math.abs(a.rotation);if(d<b.options.transform_min_scale&&e<b.options.transform_min_rotation)return;v.current.name=this.name,this.triggered||(b.trigger(this.name+"start",a),this.triggered=!0),b.trigger(this.name,a),e>b.options.transform_min_rotation&&b.trigger("rotate",a),d>b.options.transform_min_scale&&(b.trigger("pinch",a),b.trigger("pinch"+(a.scale<1?"in":"out"),a));break;case o:this.triggered&&b.trigger(this.name+"end",a),this.triggered=!1}}}},"function"==typeof define&&define.amd?define(function(){return e}):"object"==typeof b&&b.exports?b.exports=e:a.Hammer=e}(window)},{}]},{},[2]);